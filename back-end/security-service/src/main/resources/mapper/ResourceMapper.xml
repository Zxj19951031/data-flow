<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.authentication.mapper.ResourceMapper">

    <sql id="Base_Column_List">
        id, `name`, `label`, pid, `level`, sort, code, metadata, is_func, create_time, update_time,
    `status`
    </sql>
    <select id="selectByUsername" resultType="org.example.authentication.model.Resource">
        select distinct tr.*
        from tb_rel_role_resource
                 left join tb_resource tr on tb_rel_role_resource.resource_id = tr.id
        where role_id in (
            select role_id
            from tb_rel_role_user
                     left join tb_user tu on tb_rel_role_user.user_id = tu.id
            where username = #{username}
        )
          and is_func = 0
        order by sort
    </select>

</mapper>